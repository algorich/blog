
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="pt-BR"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Integração e Deploy Contínuos (Parte 1) - Blog da Algorich</title>
  
    <meta name="author" content="Douglas Oliveira Camata">
  

  
    <meta name="description" content="Como integração e deploy contínuos podem ajudar você, sua equipe e seu cliente a perderem menos tempo no dia-a-dia">
  

  
    <meta name="keywords" content="integracao continua, deploy continuo, jenkins, capistrano">
  

  <!-- start: Facebook Open Graph -->
  <meta property="fb:app_id" content="255940757884214" />
  <meta property="og:type" content="article" />
  <meta property="og:locale" content="pt_BR" />
  <meta property="og:site_name" content="algorich.com.br"/>
  <meta property="og:url" content="http://blog.algorich.com.br/2014/05/07/integracao-e-deploy-continuos/"/>
  <meta property="og:title" content="Integração e Deploy Contínuos (Parte 1) - Blog da Algorich"/>
  
    <meta property="og:description" content="Como integração e deploy contínuos podem ajudar você, sua equipe e seu cliente a perderem menos tempo no dia-a-dia" />
  
  
    <meta property="og:image" content="http://blog.algorich.com.br/posts-assets/images/2014/05/jenkins.png" />
  
  <!-- end: Facebook Open Graph -->

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://blog.algorich.com.br/2014/05/07/integracao-e-deploy-continuos/">
  <link href="/favicon.png" rel="icon">

  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <!--[if IE 9]>
    <style>.da-slide p { filter:none; }</style>
  <![endif]-->

  <link href="/atom.xml" rel="alternate" title="Blog da Algorich" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Droid+Sans:400,700">
<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Droid+Serif">
<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Boogaloo">
<link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Economica:700,400italic">
  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-23447419-6']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >

  <header id="app-main-header">
  <!--start: Container -->
  <div class="container">
    <div class="row">
      <div class="span10">
        <a class="brand" href="/">
          <img src="/img/algorich_logo.png" alt="Algorich" />
        </a>
      </div>
    </div>
  </div>
  <!--end: Container-->
</header>



  <!--start: Wrapper-->
  <div id="wrapper">

    <!--start: Container -->
    <div class="container">
      <!--start: Row -->
      <div class="row">
        <div class="span7">
          <div>
<article>
  <div class="post">
  <div class="post-content">
    
      <header>
        
          <div class="title">
            <h2>Integração e Deploy Contínuos (Parte 1)</h2>
          </div>
        
        
          <!-- start: post meta -->
          <div class="post-meta">
            <span>
              <i class="mini-ico-calendar"></i>
              








  


<time datetime="2014-05-07T14:00:00-03:00" pubdate data-updated="true">07/05/2014</time>
            </span>

            <span>
              <i class="mini-ico-user"></i>
              
  

Douglas Oliveira Camata

            </span>

            
            <span>
               <i class="mini-ico-comment"></i>
               <a href="#disqus_thread">Comentários</a>
            </span>
            
          </div>
          <!-- end: post meta -->
        
      </header>
    
    
    <div class="entry-content"><p>Quando se tem projetos com uma grande quantidade de desenvolvedores é comum nos
encontrar em uma situação onde erros com relação ao código e testes
desenvolvidos acontecem. Você pode dizer, &#8220;ah, meu projeto tem 100% de cobertura
de testes, isso nunca acontecerá&#8221;, (mesmo sabendo que 100% de cobertura de
testes é apenas uma ilusão) mas você sabe que acontece. Primeiramente, somos
humanos. Eventualmente vamos errar, até mesmo o teste pode estar errado.</p>

<p>O que fazer quando temos aquela clássica situação de &#8220;funciona na minha máquina,
o problema é na sua&#8221;? Todos já passaram por isso pelo menos uma vez na vida.
Agora, a parte que costuma ser esquecida: rodar os testes somente no seu
computador não é o suficiente! Por que? Porque ele está viciado. Sim, você já
estava com o projeto &#8220;semi pronto&#8221; e isso pode deixar passar alguns problemas.</p>

<p>O ideal, seria que você construísse um novo ambiente, do zero, realizasse todo o
processo de preparação dele para rodar a aplicação e então rodasse os testes.
Mas se o projeto é grande, rodar todos os testes já deve tomar um tempo
considerável, imagina então montar o ambiente do zero&#8230; Para nos ajudar com
este problema, nós, na Algorich a técnica de <strong>integração contínua</strong>.</p>

<!-- more -->


<h2>Integração Contínua</h2>

<p>Mas que diabos é isso?</p>

<blockquote><p>Integração Contínua é uma pratica de desenvolvimento de software onde os membros de um time integram seu trabalho frequentemente, geralmente cada pessoa integra pelo menos diariamente – podendo haver multiplas integrações por dia. Cada integração é verificada por um build automatizado (incluindo testes) para detectar erros de integração o mais rápido possível. Muitos times acham que essa abordagem leva a uma significante redução nos problemas de integração e permite que um time desenvolva software coeso mais rapidamente.</p><footer><strong>Martin Fowler,</strong> <cite><a href='http://martinfowler.com/articles/continuousIntegration.html'>martinfowler.com/articles/&hellip;</a></cite></footer></blockquote>


<p>Resumidamente, o tal &#8220;build automatizado&#8221; é quem vai fazer aquele procedimento
trabalhoso de montar o projeto em um ambiente limpo e então verificar se os
testes do projeto estão passando. Em um caso de falha de algum dos testes,
toda a equipe é rapidamente notificada via email (o que pode facilitar
integração com outros serviços externos, como o Trello). A partir dai, a equipe
pode rapidamente idenfiticar a fonte deste erro e corrigî-lo, para que não
sejam introduzidos erros no projeto junto com uma nova funcionalidade ou
refatoração.</p>

<p>Mas não para por ai, calma, jovem. Um processo de integração contínua pode
fazer muito mais por você do que você imagina. Vamos pensar: o que você precisa,
ou desejaria, que fosse feito a cada commit enviado para o repositório? Aposto
que você pensou naquele deploy para o servidor de staging. Se não pensou, ou
nem tem um servidor de staging, ou nem sabe o que é isso, meu amigo&#8230; Recomendo
que você leia <a href="http://www.kalzumeus.com/2010/12/12/staging-servers-source-control-deploy-workflows-and-other-stuff-nobody-teaches-you/" target="_blank">esse material</a>.</p>

<h2>Deploy contínuo</h2>

<p>Então, se a idéia de integração contínua é automatizar as coisas (inicialmente,
a integração do seu código com o repositório), por que não automatizar também
o deploy para o ambiente staging? Assim, seu cliente terá um ambiente muito
próximo ao de produção para poder testar as funcionalidades e encontrar bugs
enquanto isso. Acredite, a quantidade de bugs que seus clientes encontrarão
no servidor de staging vai te assustar, porque nós, desenvolvedores, não
pensamos como usuários, por mais que nos esforcemos e acabamos deixando muita
coisa passar. E nada melhor do que resolver isso antes do projeto entrar em
produção, certo?</p>

<p>Mas peraí, faltou um detalhe: não podemos deixar o ambiente de staging uma
bagunça! Vamos atualizar o código de staging se, se somente se, todos os testes
do build passarem, assim podemos ter (e dar ao cliente também) uma garantia maior
que o sistema não possui algum comportamento indesejado ou bug.</p>

<p>Agora você deve estar pensando em copiar e colar todos aqueles comandos que você
usa para fazer seu deploy, né? Pois é, vamos dar um jeito nisso. A idéia é
automatizar tudo! Testes foram automatizados para poupar tempo e evitar falha
durante este processo delicado e repetitivo dentro da metodologia ágil, por que
não automatizar o deploy também? Para cada caso, cada linguagem e até framework,
existe a ferramenta de automatização de deploy adequada. Para nossos projetos
web, onde usamos Ruby on Rails, utilizamos o <a href="http://capistranorb.com/">Capistrano</a>
para esta tarefa, que com os scripts e recipes pré-definidos, basta um simples
comando para fazermos um deploy para o servidor de staging ou produção, quando
necessário, sem qualquer preocupação, sem erros.</p>

<h2>Colocando tudo isso pra funcionar</h2>

<p>Como dito anteriormente, nós da Algorich, utilizamos integração e deploy
contínuos em nossos projetos. Para isso, usamos o
<a href="http://jenkins-ci.org/">Jenkins</a> (uma conhecida ferramenta de
integração contínua, software livre, e em constante evolução),
<a href="https://gitlab.com/">Gitlab</a> (nosso repositório de código) e o
<a href="https://trello.com">Trello</a> (organização e gerenciamento dos
projetos).</p>

<p><img class="alignright" title="Jenkins" src="/posts-assets/images/2014/05/jenkins.png" alt="Jenkins" width="200" height="200" />
E como isso tudo se junta? Bem, através do plugin
<a href="https://wiki.jenkins-ci.org/display/JENKINS/Gitlab+Hook+Plugin">Gitlab Hook</a>
para o Jenkins, ele ficará escutando em uma determinada URL para receber
requests que informarão sobre novos commits enviados ao repositório remoto. Em
seguida, configuramos nos nossos repositórios para que eles enviem essa esperada
requisição a cada push feito, através da interface de administração do Gitlab, e
pronto, temos uma build disparado no projeto. Novamente no Jenkins, dizemos
qual é o tipo de versionamento do projeto, o endereço do repositório remoto e
quais comandos ele executará após clonar o projeto. Estes comandos são:
instalação das dependências, um drop em qualquer banco de dados do projeto
existente, execução das migrações do banco de dados ou criação das tabelas,
execução dos testes e o deploy para staging. É importante notar que, caso sua
ferramenta de testes gere uma saída de erro para o terminal, o build não chegará
na parte do deploy. Caso contrário, você precisará fazer algo para &#8220;descobrir&#8221;
quando aconteceu algum erro e evitar manualmente que o deploy seja iniciado.</p>

<p>O Jenkins é uma ferramenta completíssima e com inúmeros plugins, então pensamos:
vamos integrar isso com o Trello? Vamos! E qual é a alternativa mais simples?
Não sei se vocês sabem, mas é possível criar cards em um quadro do Trello
via email. Dito e feito. Após a execução do build, em caso de falha, um email é
enviado para um board do Trello específico para nossas builds (previamente
criado por nós), que transforma-o em um card na lista correta, bingo!</p>

<h2>Conclusão</h2>

<p>Através desse grupo de ferramentas, conseguimos, dentre muitos outros pontos:</p>

<ol>
<li><p>Diminuir a quantidade de deploys enviados para staging com bugs, e ainda mais
para produção;</p></li>
<li><p>Diminuir a quantidade de pedidos do tipo &#8220;ai cara, faz um deploy pra mim&#8221;
durante todo o dia de trabalho;</p></li>
<li><p>Ter um feedback ainda mais rápido dos nossos clientes, que viam as
funcionalidades assim que o build e deploy finalizava com sucesso e o card
da tarefa no Trello era movido para &#8220;Pronto&#8221;;</p></li>
</ol>


<p>Bom galera, tentamos fazer aqui apenas uma descrição sucinta do que é deploy e
integração contínua, apresentar as ferramentas que usamos para realizar estes
importantes processos e como interligamos elas. Aguardem novos posts com
tutoriais passo-a-passo de como configurar todas elas para fazer sua própria
integração contínua!</p>
</div>
    
  </dib>
</dib>
  <footer>
    
      <div class="sharing">
  
  <a href="http://twitter.com/share" class="twitter-share-button" data-url="http://blog.algorich.com.br/2014/05/07/integracao-e-deploy-continuos/" data-via="algorich" data-counturl="http://blog.algorich.com.br/2014/05/07/integracao-e-deploy-continuos/" >Tweet</a>
  
  
  
    <div class="fb-like" data-send="true" data-width="450" data-show-faces="false"></div>
  
</div>

    

    <ul class="pagination clear">
      
        <div class="alignleft">
          <a href="/2014/04/10/cuidados-no-uso-de-factories-factorygirl/" title="Post anterior: Boa prática em testes & cuidados com FactoryGirl"><li>&laquo; Boa prática em testes & cuidados com FactoryGirl</li></a>
        </div>
      
      
    </ul>
  </footer>
</article>


  <section>
    <div id="disqus_thread" aria-live="polite"><noscript>Por favor, habilite o JavaScript para visualizar os to view the <a href="http://disqus.com/?ref_noscript">comentários fornecidos pelo Disqus.</a></noscript>
</div>
  </section>

</div>
        </div>

        <div class="span3 hidden-phone sidebar">
          <ul class="social-bookmarks">
            <li class="rss"><a href="/atom.xml">rss</a></li>
            <li class="github"><a href="//github.com/algorich">github</a></li>
            <li class="facebook"><a href="//facebook.com/algorich">facebook</a></li>
            <li class="twitter"><a href="//twitter.com/algorich">twitter</a></li>
          </ul>

          <aside>
            
              <section>
  <div class="title"><h3>Posts recentes</h3></div>
  <ul id="recent_posts">
    
      <li>
        <a href="/2014/05/07/integracao-e-deploy-continuos/">Integração e Deploy Contínuos (Parte 1)</a>
      </li>
    
      <li>
        <a href="/2014/04/10/cuidados-no-uso-de-factories-factorygirl/">Boa prática em testes & cuidados com FactoryGirl</a>
      </li>
    
      <li>
        <a href="/2013/07/25/acelerando-seu-emulador-android/">Acelerando seu emulador Android</a>
      </li>
    
      <li>
        <a href="/2013/05/27/criando-suas-proprias-funcoes-de-autocomplear-no-bash/">Criando suas próprias funções de autocomplear no Bash</a>
      </li>
    
      <li>
        <a href="/2012/07/23/iniciando-no-desenvolvimento-android-com-phonegap/">Iniciando no desenvolvimento Android com PhoneGap</a>
      </li>
    
  </ul>
</section>

<section>
  <div class="title"><h3>GitHub</h3></div>
  <ul id="gh_repos">
    <li class="loading">Atualizando status...</li>
  </ul>
  
  <a href="https://github.com/algorich">@algorich</a> on GitHub
  
  <script type="text/javascript">
    $(document).ready(function(){
        if (!window.jXHR){
            var jxhr = document.createElement('script');
            jxhr.type = 'text/javascript';
            jxhr.src = '/javascripts/libs/jXHR.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(jxhr, s);
        }

        github.showRepos({
            user: 'algorich',
            count: 4,
            skip_forks: true,
            target: '#gh_repos'
        });
    });
  </script>
  <script src="/javascripts/github.js" type="text/javascript"> </script>
</section>


<section>
  <div class="title"><h3>Tweets recentes</h3></div>
  <ul id="tweets">
    <li class="loading">Atualizando status...</li>
  </ul>
  <script type="text/javascript">
    $(function(){
      getTwitterFeed("algorich", 4, false);
    });
  </script>
  <script src="/javascripts/twitter.js" type="text/javascript"> </script>
  
    <a href="http://twitter.com/algorich" class="twitter-follow-button" data-show-count="false">Siga @algorich</a>
  
</section>

            
          </aside>
        </div>
      </div>
      <!-- end: Row -->
    </div>
    <!--end: Container-->
  </div>
  <!-- end: Wrapper  -->

  <footer><!-- start: Footer Menu -->
<div id="footer-menu" class="hidden-tablet hidden-phone">
  <div class="row-fluid">
    <!-- start: Footer Menu Logo -->
    <div class="span2">
      <div id="footer-menu-logo">
        <a class="brand" href="/">
          <img src="/img/algorich_logo_footer.png" alt="Algorich" />
        </a>
      </div>
    </div>
    <!-- end: Footer Menu Logo -->

    <!-- start: Footer Menu Links-->
    <div class="span9">
      <div id="footer-menu-links">
        <ul id="footer-nav">
          <li><a href="http://algorich.com.br">Site</a></li>
          <li><a href="/trabalhe-conosco">Trabalhe conosco</a></li>
          <li><a href="/contato">Contato</a></li>
        </ul>
      </div>
    </div>
    <!-- end: Footer Menu Links-->
  </div>
</div>
<!-- end: Footer Menu -->

<!-- start: Footer -->
<div id="footer">

  <!-- start: Row -->
  <div class="row-fluid">

    <!-- start: About -->
    <div class="span3">
      <h3>Sobre nós</h3>
      <p>
        Sabe aquelas ideias que resolvem um problema do jeito mais fácil e
        trazem um resultado de maior qualidade? Isso é o que buscamos na Algorich,
        essa é a cara da empresa. <strong>Simples e criativo, sem enrolação.</strong>
      </p>
    </div>
    <!-- end: About -->

    <!-- start: Photo Stream -->
    <div class="span3">
      <h3>Onde nos encontrar</h3>
      <div>
        <address>
  Rua Dr. Herculano Aquino, 119 - Jardim Flamboyant I<br />
  Campos dos Goytacazes - RJ - Brasil - 28015-200<br />
  Telefone: <a href="tel2227240503">(22) 2724-0503</a><br />
  Email: <a href="mailto:contato@algorich.com.br">contato@algorich.com.br</a>
</address>


        <p>
          <a href="http://goo.gl/j5PdVS" target="_blank">
            <img src="/img/map.png" alt="Algorich no mapa" id="app-map" />
          </a>
        </p>
      </div>
    </div>
    <!-- end: Photo Stream -->

    <!-- start: Follow Us -->
    <div class="span6">
      <h3>Sigam-me os bons!</h3>

      <p id="app-chapolin">
        <img src="/img/chapolin.png" alt="O Chapolin Colorado" />
      </p>

      <ul class="social-grid">
        <li>
          <div class="social-item">
            <div class="social-info-wrap">
              <div class="social-info">
                <div class="social-info-front social-facebook">
                  <a href="http://facebook.com/algorich"></a>
                </div>
                <div class="social-info-back social-facebook-hover">
                  <a href="http://facebook.com/algorich"></a>
                </div>
              </div>
            </div>
          </div>
        </li>
        <li>
          <div class="social-item">
            <div class="social-info-wrap">
              <div class="social-info">
                <div class="social-info-front social-twitter">
                  <a href="http://twitter.com/algorich"></a>
                </div>
                <div class="social-info-back social-twitter-hover">
                  <a href="http://twitter.com/algorich"></a>
                </div>
              </div>
            </div>
          </div>
        </li>
        <li>
          <div class="social-item">
            <div class="social-info-wrap">
              <div class="social-info">
                <div class="social-info-front social-github">
                  <a href="http://github.com/algorich"></a>
                </div>
                <div class="social-info-back social-github-hover">
                  <a href="http://github.com/algorich"></a>
                </div>
              </div>
            </div>
          </div>
        </li>
        <li>
          <div class="social-item">
            <div class="social-info-wrap">
              <div class="social-info">
                <div class="social-info-front social-rss">
                  <a href="http://blog.algorich.com.br/atom.xml"></a>
                </div>
                <div class="social-info-back social-rss-hover">
                  <a href="http://blog.algorich.com.br/atom.xml"></a>
                </div>
              </div>
            </div>
          </div>
        </li>
      </ul>
      <!-- end: Follow Us -->
    </div>

  </div>
  <!-- end: Row -->

</div>
<!-- end: Footer -->

<!-- start: Copyright -->
<div id="copyright">

  <p>
    &copy; 2014 <a href="http://algorich.com.br">Algorich</a>.
     Ilustrações de <a href="http://www.souzailustrador.com/">Murilo Souza</a>.
  </p>

</div>
<!-- end: Copyright -->


<!-- start: Java Script -->
<script defer src="http://sawpf.com/1.0.js"></script>
<!-- end: Java Script -->

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'algorich';
      
        
        // var disqus_developer = 1;
        var disqus_identifier = 'http://blog.algorich.com.br/2014/05/07/integracao-e-deploy-continuos/';
        var disqus_url = 'http://blog.algorich.com.br/2014/05/07/integracao-e-deploy-continuos/';
        var disqus_script = 'embed.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>





  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
